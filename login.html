<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Global styles */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-image: url(cakeBackground.jpg);
            position: relative;

        }

        /* Styles for form container */
        .container {
            width: 100%;
            max-width: 400px;
            /* Set maximum width of the form container */
            margin: auto;
            padding: 20px;
        }

        /* Styles for form inputs */
        /* input[type=date], input[type=number], input[type=text], input[type=password] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        } */

        /* Styles for submit button */
        input[type=submit],
        button {
            width: 100%;
            background-color: #4CAF50;
            color: white;
            padding: 14px 20px;
            margin-top: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        input[type=submit]:hover,
        button:hover {
            background-color: #45a049;
        }

        /* Styles for message div */
        #message {
            margin-top: 20px;
            font-weight: bold;
            text-align: center;
        }

        /* Media query for smaller screens */
        @media screen and (max-width: 600px) {
            .container {
                padding: 10px;
            }
        }

        /* Styles for modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding-left: 20px;
            padding-bottom: 20px;
            padding-right: 20px;
            border: 1px solid #888;
            color: green;
            width: 80%;
            max-width: 600px;
            text-align: center;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        #topBar {
            height: 60px;
            width: 100%;
            display: flex;
            align-items: center;

            z-index: 3;
        }

        .topBarH4Div span {
            color: green;
            font-size: 40px;
            justify-self: center;
            align-self: center;
        }

        .topBarH4Div {
            font-weight: bold;
            width: 100%;
            height: 60px;
            display: flex;
            align-content: center;
            justify-content: center;
            justify-items: center;
        }

        .topBarImg {
            height: 50px;
            width: 50px;
            z-index: 5;
        }



        big {
            color: green;
        }

        #welcome-referral {
            color: darkgreen;
        }

        body {
            background: url(cakeBackground.jpg);
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        /* Container for the menu items */
        /* Container for the menu items */
        /* Container for the menu items */
        .menu-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            padding-bottom: 0px;
        }

        /* Row that holds the menu items */
        .menu-row {
            display: flex;
            justify-content: center;
            /* Center items horizontally */
            margin-bottom: 20px;
            /* Add margin between rows */
            width: 100%;
            box-sizing: border-box;
        }

        /* Individual menu item styling */
        .menu-item {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin: 10px;
            padding: 15px;
            width: 170px;
            /* Fixed width */
            text-align: center;
            flex: 0 0 auto;
            /* Prevents stretching */
            box-sizing: border-box;
        }

        /* Styling for images in menu items */
        .menu-item img {
            border-radius: 10%;
            width: 100%;
            height: 130px;
        }

        /* Styling for text in menu items */
        .menu-item span {
            display: block;
            margin: 10px 0;
            font-size: 16px;
        }

        /* Styling for buttons in menu items */
        .menu-item button {
            background-color: blue;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 5px;
            width: 105px;
        }

        /* Styling for quantity controls */
        .quantity-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 5px;
        }

        .quantity-controls .quantityControlButtonAdd {
            background-color: green;
            border: none;
            padding: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 5px;
        }

        .quantity-controls .quantityControlButtonSub {
            background-color: red;
            border: none;
            padding: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 5px;
        }

        .quantity-controls input {
            width: 40px;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            text-align: center;
            font-size: 16px;
        }

        /* Styling for cart button */
        .cart-button {
            margin-top: 5px;
            margin-bottom: 65px;
            width: 100%;
            background-color: orange;
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 18px;
            border: none;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
        }

        .cart-button:hover {
            background-color: darkorange;
        }

        /* Styling for message */
        .message {
            color: green;
            font-size: 18px;
            font-weight: bold;
            margin-top: 0px;
        }

        /* Hidden class */
        .hidden {
            display: none;
        }




        .a {
            display: flex;
        }

        #name {
            width: 49%;
            padding: 12px 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        #dob {
            width: 49%;
            padding: 12px 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        #textAndInput {
            display: flex;
            align-items: center;
            justify-content: space-evenly;
        }

        .nameRecordAndDobRecord {
            margin-top: 5px;
            display: flex;
            justify-content: space-between;
            height: 30px;
        }

        #recordsListName {
            align-items: center;
            justify-content: center;
            align-content: center;
            width: 175px;
        }

        #recordsListDob {
            align-items: center;
            justify-content: center;
            align-content: center;
            width: 175px;
        }

        .allRecords {
            display: flex;
            justify-content: space-between;
        }




        @keyframes a {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        @keyframes b {
            0% {
                border-width: 5;
            }

            50% {
                border-width: 0;
            }

            100% {
                border-width: 5;
            }
        }

        #aDiv {
            padding-top: 20px;
            text-align: center;

        }

        #aDiv big {

            text-align: center;


        }

        #off {
            text-align: center;
            animation: a 0.70s infinite;
            padding-top: 25px;
        }

        #off big {

            text-align: center;
            font-size: 25px;
        }

        .slider_container {
            position: relative;
            width: 100%;
            height: 180px;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            overflow: hidden;
            margin-top: 1px;
        }

        .slider {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            animation: 30s cubic-bezier(1, 0.95, 0.565, 1) sliding infinite;
        }

        .slide {
            position: relative;
            min-width: 100%;
            height: 100%;
        }

        .slide img {
            width: 100%;
            height: 100%;
        }

        .slide.one {
            background: linear-gradient(180deg, white, lightgreen, darkgreen)
        }

        .slide.two {
            /* background: rgb(255, 64, 64); */
        }

        .slide.three {
            /* background: rgb(11, 173, 188);
 */
        }

        .slide.four {
            /* background: rgb(11, 188, 14); */
        }

        .slide.five {
            /* background: rgb(173, 11, 188); */
        }

        @keyframes sliding {
            0% {
                transform: translateX(0%);
            }

            20% {
                transform: translateX(0%);
            }

            25% {
                transform: translateX(-100%);
            }

            45% {
                transform: translateX(-100%);
            }

            50% {
                transform: translateX(-200%);
            }

            70% {
                transform: translateX(-200%);
            }

            75% {
                transform: translateX(-300%);
            }

            95% {
                transform: translateX(-300%);
            }

            100% {
                transform: translateX(-400%);
            }
        }

        .sliderImage1 {
            padding-left: 20px;
        }

        .sliderImage2 {
            padding-right: 20px;
        }

        .sliderImageAll {
            padding-top: 30px;
            justify-content: space-between;
            display: flex;
        }

        #rightMenuBar {
            visibility: hidden;
            width: 250px;
            height: 355px;
            position: fixed;
            right: 0px;
            bottom: 70px;
            z-index: 100;
            background-color: white;
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 10px;
            overflow-y: auto;
            transform: translateY(100%);
            /* Start off-screen */
            transition: transform 0.5s ease;
            /* I want that it should come from down to it actual position */
            /* animation: rightMenuBarAnimation 0.5s ease-out forwards; */
        }

        #rightMenuBar.show {
            transform: translateY(0);
            animation: rightMenuBarAnimation 1s ease-in-out 1;

            visibility: visible;
            /* Move to its original position */
        }


        @keyframes rightMenuBarAnimation {

            /* 10% {
       opacity: 0.10;
    } 50% {
        opacity: 0.50;
    } 80% {
        opacity: 0.80;
    } 100% {
        opacity: 1;
    } */
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .category-container {
            text-align: center;
        }

        @keyframes a {
            0% {
                display: none;
            }

            50% {
                display: none;
            }

            100% {
                display: block;
            }
        }

        #whatsappIcon {
            position: fixed;
            right: 10px;
            bottom: 130px;
            background-color: black;
            z-index: 1000;
            visibility: visible;
            height: 45px;
            width: 45px;
            border-radius: 7px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-width: 4px;
            border-style: bold;
            border-color: green;
        }

        .modal-description {
            word-wrap: break-word;
            /* Break long words */
            overflow-wrap: break-word;
            /* Ensure long words break correctly */
            white-space: pre-wrap;
            /* Preserve whitespace and wrap text */
            text-align: left;
        }

        .close-button {
            color: black;
            float: right;
            font-size: 40px;
            position: absolute;
            right: 20px;
            /* font-weight: bold;
            height: 70px;
            width: 70px;
            text-align: center; */
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }



        .loader {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: none;
            border-top: 4px solid black;
            border-right: 4px solid transparent;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
            position: absolute;
            margin-top: 50vh;
            margin-left: 45vw;

        }

        .loader::after {
            content: '';
            box-sizing: border-box;
            position: absolute;
            left: 0;
            top: 0;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border-left: 4px solid black;
            border-bottom: 4px solid transparent;
            animation: rotation 0.5s linear infinite reverse;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body id="body">
    <span class="loader"></span>
    <div id='mainDiv'>



        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
            integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
            crossorigin="anonymous" referrerpolicy="no-referrer" />
        <div id="whatsappIcon" onclick="openWhatsapp()">
            <i class="fa-brands fa-whatsapp fa-beat fa-2xl" style="color: #00ff40;"></i>
        </div>
        <script>
            function openWhatsapp() {
                window.open("https://wa.me/9664478500")
            }
        </script>
        <div id="rightMenuBar">
            <div style="margin-left: 20px;">
                <span style="font-size: 20px; font-weight: 800; color: darkgreen;">eekh</span>
                <img style="height: 20px; width: 20px; position: absolute; right: 10px; top: 10px;" src="crossImage.png"
                    alt="cross" onclick="closeMenu()">
                <div style="align-items: center; align-content: center;height: 20px; display: flex; margin-top: 10px; cursor: pointer;"
                    onclick="goToIndex()">
                    <img style="height: 20px; width: 20px;" src="logoutImage.png" alt="logout">
                    <span style="margin-left: 10px;">Logout</span>
                </div>

                <div style="align-items: center; align-content: center;height: 20px; display: flex; margin-top: 10px; cursor: pointer;"
                    onclick="goToWallet()">
                    <img onclick="goToWallet()" src="walletImage.png" style="height: 20px; width: 20px;" alt="logout">
                    <span style="margin-left: 10px;">Wallet</span>
                </div>

                <div style="align-items: center; align-content: center;height: 20px; display: flex; margin-top: 10px; cursor: pointer;"
                    onclick="goToMyOrders()">
                    <img onclick="goToMyOrders()" src="myOrdersImage.png" style="height: 20px; width: 20px;"
                        alt="logout">
                    <span style="margin-left: 10px;">My Orders</span>
                </div>

                <div style="align-items: center; align-content: center;height: 20px; display: flex; margin-top: 10px; cursor: pointer;"
                    onclick="goToCart()">
                    <img onclick="goToCart()" src="cartImage.png" style="height: 20px; width: 20px;" alt="logout">
                    <span style="margin-left: 10px;">My Cart</span>
                </div>

                <div style="align-items: center; align-content: center;height: 20px; display: flex; margin-top: 10px; cursor: pointer;"
                    onclick="goToMyReffered()">
                    <img onclick="goToMyReffered()" src="referralLogo.png" style="height: 20px; width: 20px;"
                        alt="logout">
                    <span style="margin-left: 10px;">My Referrals</span>
                </div>
            </div>
        </div>

        <div
            style="display: flex; background-color: white; height: 70px; align-content: center; position: fixed; bottom: 0px; width: 100%; justify-content: space-between; ">
            <img onclick="goToWallet()" src="walletImage.png" alt="" style="height: 50px;width: 50;  margin-top: 10px;">
            <img onclick="goToMyOrders()" src="myOrdersImage.png" alt=""
                style="height: 50px;width: 50;  margin-top: 10px;">
            <button
                style="width:fit-content; background-color: transparent; padding: 0px; margin-top: -10px; border: 0px; border-radius: 0px; cursor:none;"
                id="goToCartImage" onclick="goToCart()"><img src="cartImage.png" alt=""
                    style="height: 50px;width: 50;  margin-top: 10px; "></button>
            <img style="height: 50px;width: 50;  margin-top: 10px;" class="topBarImg" src="menuImage.png" alt="sad"
                onclick="openMenu()">

        </div>

        <div>

            <div id="topBar">
                <div class="topBarH4Div">
                    <span>eekh</span>
                </div>
                <!-- <div class="topBarImgDiv" >
         <img class="topBarImg" src="menuImage.png" alt="sad">
    </div> -->
            </div>
            <div class="container">
                <section class="slider_container">
                    <section class="slider">
                        <div class="slide first" style="border-width: 2px; border-style: solid; border-color: red;">
                            <img style="animation: a 2s infinite;" src="sliderImage6.png" alt="" />
                            <span style="animation: a 2s infinite;" class="caption"> slide first </span>


                            <div class="slide one">

                                <div class="sliderImageAll">




                                    <div class="sliderImage1">
                                        <img class="myImage1" src="cake1.jpeg" alt="image"
                                            style="width:80px;  height: 80px; border-style: solid; border-width: 5; animation: b 1s infinite;">
                                    </div>
                                    <div id="off">
                                        <big><big><u><span>*Rs.100 off*</span></u></big></big>
                                    </div>
                                    <div class="sliderImage2">
                                        <img class="myImage2" src="cake1.jpeg" alt="image"
                                            style="width:80px;  height: 80px; border-style: solid; border-width: 5; animation: b 1s infinite;">
                                    </div>

                                </div>
                                <div id="aDiv">
                                    <big style="color: #fefefe;">Please Fill the Below Feilds You will get</big>
                                </div>
                            </div>
                        </div>



                        <div class="slide two">
                            <img src="coffeeSlider.png" alt="" />
                            <span class="caption"> slide two </span>
                        </div>
                        <div class="slide three">
                            <img src="sliderImage3.jpeg" alt="" />
                            <span class="caption"> slide three </span>
                        </div>
                        <div class="slide four">
                            <img src="sliderImage4.jpeg" alt="" />
                            <span class="caption"> slide four </span>
                        </div>
                        <div class="slide five">
                            <img src="sliderImage5.jpeg" alt="" />
                            <span class="caption"> slide five </span>
                        </div>


                    </section>
                </section>






                <script>
                    const images1 = ['cake1.jpeg', 'cake2.jpeg', 'cake3.jpeg', 'cake4.jpeg', 'cake5.jpeg']
                    const images2 = ['cake2.jpeg', 'cake3.jpeg', 'cake4.jpeg', 'cake5.jpeg', 'cake1.jpeg']
                    let currentIndex1 = 0;
                    let currentIndex2 = 0;

                    function changeImage() {
                        const imgs1 = document.querySelectorAll('.myImage1');
                        const imgs2 = document.querySelectorAll('.myImage2');
                        currentIndex1 = (currentIndex1 + 1) % images1.length;
                        currentIndex2 = (currentIndex2 + 1) % images2.length;
                        imgs1.forEach(img => img.src = images1[currentIndex1]);
                        imgs2.forEach(img => img.src = images2[currentIndex2]);

                    }

                    setInterval(changeImage, 1000)
                </script>




                <span style="font-size: 20px; font-weight: 700;" id="welcome-message">Loading...</span>


                <form id="info-form">
                    <div class="textAndInput">
                        <input type="text" id="name" placeholder="Name" required maxlength="16">
                        <input type="date" id="dob" required placeholder="Please Enter Date Of Birth">
                    </div>
                    <button style="margin-bottom: 5px;" type="submit">Submit</button>
                </form>
                <span style="font-size: 15px; font-weight: bold;" id="welcome-referral">Loading...</span>
                <div class="record">
                    <div class="nameRecordAndDobRecord">

                        <span style="width: 175px; font-size: 18px; font-weight: bolder;height: 20px;"
                            class="nameRecord">Name</span>
                        <span style="width: 175px; font-size: 18px; font-weight: bolder;height: 20px;"
                            class="dobRecord">DOB</span>

                    </div>
                    <div class="allRecords">
                        <div style=" color: green; font-size: 14px; " id="recordsListName">Loading...</div>

                        <div style=" color: green; font-size: 14px; " id="recordsListDob">Loading...</div>
                    </div>
                </div>

                <div style="height: 60px; width: 100%; background-color: hsla(0, 0%, 0%, 0.633); border-radius: 10px; display: flex; align-items: center; justify-content: space-evenly; margin-top: 10px;"
                    onclick="refer()">
                    <i class="fa-solid fa-gift fa-bounce" style="color: #FFD43B;"></i>
                    <div style="display: flex; flex-direction: column;">
                        <p style="color: white; margin: 0px; padding: 0px;">Refer and earn</p>
                        <p style="color: rgba(212, 207, 207, 0.817); margin: 0px; padding: 0px; font-size: 12px;">Earn
                            5% on
                            every referral's
                            purchase</p>
                    </div>
                    <div>
                        <p
                            style="height: 30px; align-self: center; justify-self: center; background-color: white; width: 90px; border-radius: 5px; color: black; text-align: center; font-size: 14px; text-align: center; display:flex; align-items: center; justify-content: center;">
                            Refer Now > </p>
                    </div>
                </div>

                <script>
                    function refer() {
                        const queryParams = new URLSearchParams(window.location.search);
                        const mobile = queryParams.get('mobile');
                        if (navigator.share) {
                            navigator.share({

                                title: '',
                                url: 'https://eekh24.github.io/eekh/signUp.html?referralNumber=' + mobile
                            }).then(() => {
                                console.log('Thanks for sharing!');
                            }).catch((error) => {
                                console.error('Error sharing:', error);
                            });
                        } else {
                            alert('Share not supported on this browser.');
                        }
                    }
                </script>

                <div id="message"></div>
                <!-- <hr>
            <p><u><b>Our Servings</b></u></p>
            <hr>
            <pre><b>1.  <a href="cake.html">Cake</a></b></pre>
            <pre><b>2.  <a href="pizza.html">Pizza</a></b></pre>
            <pre><b>3.  <a href="index.html">Ice Cream</a></b></pre>
            <pre><b>4.  <a href="index.html">Cold Coffee</a></b></pre>


            <hr> -->


                <!-- Reset Password Modal -->
                <div id="resetPasswordModal" class="modal">
                    <div class="modal-content">
                        <span class="close" id="closeresetmodal">&times;</span>
                        <h2>Reset Password</h2>
                        <input type="text" id="reset-mobile" placeholder="Enter your registered mobile number" required>
                        <button id="sendOtpButton">Send OTP</button>

                        <div id="otpSection" style="display:none;">
                            <input type="text" id="otp" placeholder="Enter OTP" required>
                            <button id="verifyotp">Verify OTP</button>
                        </div>

                        <div id="newPasswordSection" style="display:none;">
                            <input type="password" id="new-password" placeholder="Enter new password" required>
                            <button id="resetpassword">Reset Password</button>
                        </div>
                    </div>
                </div>







                <!-- Modal Structure -->
                <div id="item-modal" class="modal">
                    <div class="modal-content" style="border-radius: 7px;">
                        <span class="close-button">&times;</span>
                        <div id="modalImageDiv" style="margin-top: 40px;">
                            <div style="overflow: scroll; display: flex; scrollbar-color: #007 #bada55; gap: 5px;">
                                <img id="modal-item-image" src="" alt=""
                                    style="width: 100%; height: auto; border-radius: 7px;" />
                                <!-- <img src="cake1.jpeg" alt="" style="width: 100%; height: auto; border-radius: 7px;" /> -->
                            </div>
                        </div>
                        <h4 id="modal-item-name"></h4>
                        <p id="modal-item-price" class="modal-price"></p>
                        <p id="modal-item-description" class="modal-description"></p>
                    </div>
                </div>



                <div class="menu-container">

                </div>

                <button class="cart-button" onclick="goToCart()">Go to Cart</button>

            </div>


        </div>

        <!-- Button to open the Reset Password Modal -->

        <script type="module">
            import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js';
            import { getFirestore, doc, getDoc, addDoc, collection, getDocs, updateDoc, setDoc, deleteDoc, query, where } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js';
            import { getAuth, signInWithPhoneNumber, RecaptchaVerifier } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js';

            const firebaseConfig = {
                apiKey: "AIzaSyDjpg5dNL6R44dPpoDQabNaT8tLVmVWTQQ",
                authDomain: "eekh-website.firebaseapp.com",
                databaseURL: "https://eekh-website-default-rtdb.firebaseio.com",
                projectId: "eekh-website",
                storageBucket: "eekh-website.appspot.com",
                messagingSenderId: "276234231567",
                appId: "1:276234231567:web:1509267f60d97a83cea87a",
                measurementId: "G-QX5HCKXMDK"
            };

            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);
            const auth = getAuth(app);


            // Get query parameters
            const queryParams = new URLSearchParams(window.location.search);
            const mobile = queryParams.get('mobile');

            async function fetchMenuItems() {
                const body = document.getElementById('body')
                const mainDiv = document.getElementById('mainDiv')
                mainDiv.style.pointerEvents = 'none';
                mainDiv.style.opacity = '0.5';

                const loader = document.querySelector('.loader')
                loader.style.display = 'inline-block'
                const menuContainer = document.querySelector(".menu-container");
                const querySnapshot = await getDocs(collection(db, "menu-items"));

                const subCategoryOrder = [
                    "Cake 1 Pound", "Cake 2 Pound", "Layer Cake", "Kids Cake",
                    "Birthday-Accessories", "Photo Cake", "Designer Cake",
                    "OTC Pizza", "SweetCorn Pizza", "Ice-cream Cup", "Ice-cream Pack",
                    "Ice-cream Brick", "Ice-cubes"
                ];

                const categoryOrder = [
                    "Cake", "Pizza", "Ice-cream", "Birthday-Accessories", "Ice-cube"
                ];

                const categories = {};

                querySnapshot.forEach((doc) => {
                    const itemData = doc.data();
                    const displayName = itemData.name.replace(/-/g, ' ');

                    const category = itemData.category || "Uncategorized";
                    const subCategory = itemData.subCategory || "Uncategorized";

                    if (!categories[category]) {
                        categories[category] = {};
                    }

                    if (!categories[category][subCategory]) {
                        categories[category][subCategory] = [];
                    }

                    const itemElement = document.createElement("div");
                    itemElement.className = "menu-item";
                    itemElement.innerHTML = `
            <img src="${itemData.image}" alt="${displayName}" class="item-image" data-description="${itemData.description}" data-image="${itemData.image}">
            <span>${displayName}</span>
            <span style="color: green;">â‚¹${itemData.price}</span>
            <div id="quantity-controls-${itemData.name}" class="quantity-controls hidden">
                <button class="quantityControlButtonSub" onclick="decreaseQuantity('quantity-${itemData.name}')">-</button>
                <input readonly type="number" id="quantity-${itemData.name}" value="1" min="1">
                <button class="quantityControlButtonAdd" onclick="increaseQuantity('quantity-${itemData.name}')">+</button>
            </div>
            <button onclick="handleAddToCart('${itemData.name}', '${itemData.price}', '${itemData.image}', '${itemData.name}', '${itemData.category}', '${itemData.subCategory}')" id="add-to-cart-${itemData.name}">Add to Cart</button>
        `;

                    categories[category][subCategory].push(itemElement);
                });

                const sortedCategories = Object.keys(categories).sort((a, b) => {
                    return categoryOrder.indexOf(a) - categoryOrder.indexOf(b);
                });

                sortedCategories.forEach(category => {
                    const categoryContainer = document.createElement("div");
                    categoryContainer.className = "category-container";
                    const categoryTitle = document.createElement("h2");
                    categoryTitle.textContent = category;
                    categoryContainer.appendChild(categoryTitle);

                    const subCategories = Object.keys(categories[category]).sort((a, b) => {
                        return subCategoryOrder.indexOf(a) - subCategoryOrder.indexOf(b);
                    });

                    subCategories.forEach(subCategory => {
                        const subCategoryContainer = document.createElement("div");
                        subCategoryContainer.className = "subcategory-container";
                        const subCategoryTitle = document.createElement("h3");
                        subCategoryTitle.textContent = subCategory;
                        subCategoryContainer.appendChild(subCategoryTitle);

                        let currentRow = document.createElement('div');
                        currentRow.className = 'menu-row';
                        let itemCount = 0;

                        categories[category][subCategory].forEach(itemElement => {
                            currentRow.appendChild(itemElement);
                            itemCount++;

                            if (itemCount % 2 === 0) {
                                subCategoryContainer.appendChild(currentRow);
                                currentRow = document.createElement('div');
                                currentRow.className = 'menu-row';
                            }
                        });

                        if (itemCount % 2 !== 0) {
                            subCategoryContainer.appendChild(currentRow);
                        }

                        categoryContainer.appendChild(subCategoryContainer);
                    });

                    menuContainer.appendChild(categoryContainer);
                });

                // Add event listeners to images for opening the modal
                document.querySelectorAll('.item-image').forEach(img => {
                    img.addEventListener('click', (event) => {
                        const description = event.target.getAttribute('data-description');
                        const itemName = event.target.alt;
                        const itemImage = event.target.getAttribute('data-image');
                        const itemPrice = event.target.getAttribute('data-price');

                        document.getElementById('modal-item-name').textContent = itemName;
                        document.getElementById('modal-item-description').textContent = description;
                        document.getElementById('modal-item-price').textContent = itemPrice;
                        document.getElementById('modal-item-image').src = itemImage;

                        document.getElementById('item-modal').style.display = 'block';
                    });
                });

                // Add event listener for closing the modal
                document.querySelector('.close-button').addEventListener('click', () => {
                    document.getElementById('item-modal').style.display = 'none';
                });

                // Add event listener for clicking outside the modal to close it
                window.addEventListener('click', (event) => {
                    if (event.target === document.getElementById('item-modal')) {
                        document.getElementById('item-modal').style.display = 'none';
                    }
                });
                loader.style.display = 'none'
                mainDiv.style.opacity = '1';
                mainDiv.style.pointerEvents = 'auto';
            }



            if (mobile) {
                const userRef = doc(db, 'users', mobile);
                const docSnap = await getDoc(userRef);

                const welcomeMessage = document.getElementById('welcome-message');
                const welcomereferral = document.getElementById('welcome-referral');
                const nameInput = document.getElementById('name');
                const dobInput = document.getElementById('dob');
                const recordsListName = document.getElementById('recordsListName');
                const recordsListDob = document.getElementById('recordsListDob');

                if (docSnap.exists()) {
                    const userData = docSnap.data();
                    const userName = userData.name;
                    const userReferral = userData.referralPhoneNumber;
                    welcomeMessage.textContent = `Welcome, ${userName}!`;
                    welcomereferral.textContent = `Referred By, ${userReferral}`;
                } else {
                    welcomeMessage.textContent = 'User not found!';
                    welcomereferral.textContent = 'No referral found!';
                }

                // Handle form submission
                const infoForm = document.getElementById('info-form');
                infoForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const name = nameInput.value;
                    const dob = dobInput.value;

                    try {
                        // Query Firestore to check if a record with the same name and DOB already exists
                        const querySnapshot = await getDocs(query(
                            collection(db, 'users', mobile, 'records'),
                            where('name', '==', name),
                            where('dob', '==', dob)
                        ));

                        if (!querySnapshot.empty) {
                            // If a document is found, alert the user
                            alert('A record with the same name and DOB already exists.');
                        } else {
                            // Add the new record to Firestore if no matching record is found
                            const docRef = await addDoc(collection(db, 'users', mobile, 'records'), {
                                name: name,
                                dob: dob
                            });
                            console.log('Record added successfully:', docRef.id);
                        }
                        fetchRecords()
                    } catch (error) {
                        console.error('Error checking for existing record:', error);
                    }
                });




                // Function to fetch and display all records
                async function fetchRecords() {
                    recordsListName.innerHTML = 'Loading...';
                    recordsListDob.innerHTML = 'Loading...'; // Show loading text

                    try {
                        const snapshot = await getDocs(collection(db, 'users', mobile, 'records'));
                        recordsListName.innerHTML = ''; // Clear loading text
                        recordsListDob.innerHTML = '';

                        if (snapshot.empty) {
                            recordsListName.textContent = 'No My Family Members.';
                            recordsListDob.textContent = '';
                        } else {
                            snapshot.forEach(doc => {
                                const data = doc.data();
                                const lineBreak = document.createElement('br');
                                const recordElementName = document.createElement('div');
                                const recordElementDob = document.createElement('div');
                                recordElementName.textContent = `${data.name}`;
                                recordElementDob.innerHTML = `${data.dob}`;
                                recordsListName.appendChild(recordElementName);
                                recordsListDob.appendChild(recordElementDob);
                                // recordsListName.style.backgroundColor ='lightblue'
                                // recordsListDob.style.backgroundColor ='seagreen'

                            });
                        }
                    } catch (e) {
                        console.error('Error fetching records: ', e);
                        recordsListName.textContent = 'Failed to My Family Members.';
                        recordsListDob.textContent = 'Failed to My Family Members.';
                    }
                }

                // Fetch and display records on page load
                fetchRecords();
            } else {
                alert('User not found.');
            }


            fetchMenuItems();




























            // Function to handle increasing item quantity
            // Update cart quantity function

            // Increase quantity function
            window.increaseQuantity = async function (quantityId) {
                document.querySelector('.cart-button').disabled = true;
                document.querySelector('#goToCartImage').disabled = true;
                console.log('Buttons disabled');

                // Re-enable the buttons after 5 seconds
                // setTimeout(function () {
                //     document.querySelector('.cart-button').disabled = false;
                //     document.querySelector('#goToCartImage').disabled = false;
                //     console.log('Buttons re-enabled');
                // }, 5000);

                try {
                    console.log(`Increasing quantity for ${quantityId}`);
                    const input = document.getElementById(quantityId);
                    if (input) {
                        const newQuantity = parseInt(input.value) + 1;
                        input.value = newQuantity;
                        await updateCartQuantity(quantityId, newQuantity);
                    } else {
                        console.error(`Quantity input not found for ${quantityId}`);
                    }
                    document.querySelector('.cart-button').disabled = false;
                    document.querySelector('#goToCartImage').disabled = false;
                    console.log('Buttons re-enabled');
                } catch (error) {
                    console.error("Error increasing quantity:", error);
                }
            };



            // Function to handle decreasing item quantity
            function decreaseQuantity(quantityId) {
                document.querySelector('.cart-button').disabled = true;
                document.querySelector('#goToCartImage').disabled = true;
                console.log('Buttons disabled');

                try {
                    const quantityInput = document.getElementById(quantityId);
                    if (!quantityInput) {
                        console.error(`Quantity input with ID ${quantityId} not found`);
                        return;
                    }

                    let currentQuantity = parseInt(quantityInput.value, 10);
                    if (currentQuantity > 1) {
                        currentQuantity--;
                        quantityInput.value = currentQuantity;
                        updateCartQuantity(quantityId, currentQuantity);
                    } else if (currentQuantity === 1) {
                        // Remove the item from the cart if the quantity is 1 and the user tries to decrease it
                        removeFromCart(quantityId);
                    }

                    // Re-enable the buttons immediately after updating/removing the item
                    document.querySelector('.cart-button').disabled = false;
                    document.querySelector('#goToCartImage').disabled = false;
                    console.log('Buttons re-enabled');
                } catch (error) {
                    console.error("Error decreasing quantity:", error);
                }
            }



            // Function to update cart quantity
            async function updateCartQuantity(quantityId, quantity) {
                document.querySelector('.cart-button').disabled = true;
                document.querySelector('#goToCartImage').disabled = true;
                console.log('Buttons re-enabled');
                try {
                    console.log(`Updating cart quantity for ${quantityId} to ${quantity}`);

                    // Extract the item name from the quantityId
                    const itemName = quantityId.split('-').slice(1).join('-'); // Adjust based on your ID format
                    console.log(`Item name extracted: ${itemName}`);

                    const cartRef = collection(db, 'users', mobile, 'cart');
                    const querySnapshot = await getDocs(cartRef);

                    let itemExists = false;

                    for (const doc of querySnapshot.docs) {
                        const data = doc.data();
                        if (data.itemName === itemName) {
                            itemExists = true;
                            if (quantity > 0) {
                                // Update the item quantity if it's greater than 0
                                await setDoc(doc.ref, {
                                    ...data,
                                    quantity: quantity.toString(),
                                    itemImage: data.itemImage // Assuming itemImage should be updated
                                });
                                console.log(`Updated cart quantity for item: ${itemName}, new quantity: ${quantity}`);
                            } else {
                                // Remove the item if quantity is 0
                                await removeDoc(doc.ref);
                                console.log(`Removed item: ${itemName} from the cart`);
                            }
                            break;
                        }
                    }

                    if (!itemExists) {
                        console.error(`Item ${itemName} not found in cart.`);
                    }

                    document.querySelector('.cart-button').disabled = false;
                    document.querySelector('#goToCartImage').disabled = false;
                    console.log('Buttons re-enabled');
                } catch (error) {
                    console.error("Error updating cart quantity:", error);
                }
            }

            async function removeFromCart(quantityId) {
                document.querySelector('.cart-button').disabled = true;
                document.querySelector('#goToCartImage').disabled = true;
                console.log('Buttons disabled');
                try {
                    console.log(`Removing item associated with ${quantityId} from cart`);

                    // Extract the item name from the quantityId
                    const itemName = quantityId.split('-').slice(1).join('-'); // Adjust based on your ID format
                    console.log(`Item name extracted: ${itemName}`);

                    const cartRef = collection(db, 'users', mobile, 'cart');
                    const querySnapshot = await getDocs(cartRef);

                    for (const doc of querySnapshot.docs) {
                        const data = doc.data();
                        if (data.itemName === itemName) {
                            await deleteDoc(doc.ref);
                            console.log(`Removed item: ${itemName} from the cart`);

                            // Optionally, update the UI to hide quantity controls and show "Add to Cart" button
                            document.querySelector(`#add-to-cart-${itemName}`).classList.remove('hidden');
                            document.querySelector(`#quantity-controls-${itemName}`).classList.add('hidden');
                            break;
                        }
                    }
                    document.querySelector('.cart-button').disabled = false;
                    document.querySelector('#goToCartImage').disabled = false;
                    console.log('Buttons re-enabled');
                } catch (error) {
                    console.error("Error removing item from cart:", error);
                }
            }




            // Function to handle adding an item to the cart
            async function handleAddToCart(itemName, itemPrice, itemImage, quantityControlsId, category, subCategory) {
                // Disable the buttons
                document.querySelector('.cart-button').disabled = true;
                document.querySelector('#goToCartImage').disabled = true;
                console.log('Buttons disabled');

                // Re-enable the buttons after 5 seconds
                // setTimeout(function () {
                //     document.querySelector('.cart-button').disabled = false;
                //     document.querySelector('#goToCartImage').disabled = false;
                //     console.log('Buttons re-enabled');
                // }, 5000);

                try {
                    console.log(`Adding ${itemName} to cart`);

                    const cartButton = document.querySelector(`#add-to-cart-${itemName}`);
                    const quantityControls = document.querySelector(`#quantity-controls-${itemName}`);

                    if (!cartButton) {
                        console.error(`Cart button not found for item ${itemName}`);
                        return;
                    }
                    if (!quantityControls) {
                        console.error(`Quantity controls not found for item ${itemName}`);
                        return;
                    }

                    // Hide the "Add to Cart" button and show quantity controls
                    cartButton.classList.add('hidden');
                    quantityControls.classList.remove('hidden');

                    // Reference to the cart in Firestore
                    const cartRef = collection(db, 'users', mobile, 'cart');

                    // Add the item to the cart
                    await addDoc(cartRef, {
                        itemName: itemName,
                        itemImage: itemImage,
                        quantity: "1",
                        itemPrice: itemPrice,
                        category: category,
                        subCategory: subCategory
                    });

                    console.log(`${itemName} added to cart successfully`);
                    document.querySelector('.cart-button').disabled = false;
                    document.querySelector('#goToCartImage').disabled = false;
                    console.log('Buttons re-enabled');
                } catch (error) {
                    console.error("Error adding item to cart:", error);
                }
            }

            // Load cart data and synchronize UI elements
            async function loadCartData() {
                console.log("Loading cart data...");
                const cartRef = collection(db, 'users', mobile, 'cart');

                try {
                    const querySnapshot = await getDocs(cartRef);
                    const cartItems = {};

                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        cartItems[data.itemName] = data.quantity;
                    });

                    console.log("Cart items loaded:", cartItems);

                    for (const itemName in cartItems) {
                        const quantity = cartItems[itemName];
                        const quantityInput = document.getElementById(`quantity-${itemName}`);
                        const quantityControls = document.getElementById(`quantity-controls-${itemName}`);
                        const addToCartButton = document.getElementById(`add-to-cart-${itemName}`);

                        if (quantityInput && quantityControls && addToCartButton) {
                            quantityInput.value = quantity;
                            quantityControls.classList.remove('hidden');
                            addToCartButton.classList.add('hidden');
                        } else {
                            console.error(`UI elements not found for item ${itemName}`);
                        }
                    }
                } catch (error) {
                    console.error("Error loading cart data:", error);
                }
            }





            // Initialize on page load

            // Navigation functions
            function goToCart() {
                window.location.href = `Cart.html?mobile=${mobile}`;
            }
            function goToWallet() {
                window.location.href = `wallet.html?mobile=${mobile}`;
            }
            function goToMyOrders() {
                window.location.href = `myOrders.html?mobile=${mobile}`;
            }
            function goToIndex() {
                window.location.href = `index.html?`;
            }

            //This function opens the right menu bar
            function openMenu() {
                //Get the right menu bar element
                const rightMenuBar = document.getElementById('rightMenuBar');
                // rightMenuBar.classList.toggle('show');

                if (rightMenuBar.classList.contains('show')) {
                    rightMenuBar.classList.remove('show');
                    // setTimeout(() => rightMenuBar.style.visibility = 'hidden', 500); // Hide after transition
                } else {
                    rightMenuBar.style.visibility = 'visible'; // Make visible before sliding up
                    rightMenuBar.classList.add('show');
                }
                //Set the visibility of the right menu bar to visible
                // rightMenuBar.style.visibility = 'visible';


                // if (rightMenuBar.style.visibility === 'hidden' || rightMenuBar.style.visibility === '') {
                //     rightMenuBar.style.visibility = 'visible';
                //     rightMenuBar.style.animation = 'rightMenuBarAnimation 0.5s ease-out forwards';
                // } else {
                //     rightMenuBar.style.visibility = 'hidden';
                // }
            }
            function closeMenu() {
                const rightMenuBar = document.getElementById('rightMenuBar');
                rightMenuBar.style.visibility = 'hidden';
            }

            function goToMyReffered() {
                window.location.href = `myReffered.html?mobile=${mobile}`;
            }

            window.onload = (loadCartData())

            // window.onload = (syncMenuItemQuantities())

            // Expose functions globally
            window.handleAddToCart = handleAddToCart;
            window.decreaseQuantity = decreaseQuantity;
            // window.increaseQuantity = increaseQuantity;
            // window.updateCartQuantity = updateCartQuantity;
            window.goToCart = goToCart;
            window.openMenu = openMenu;
            window.closeMenu = closeMenu;
            window.goToIndex = goToIndex;
            window.goToMyOrders = goToMyOrders;
            window.goToWallet = goToWallet;
            window.goToMyReffered = goToMyReffered;


        </script>
    </div>
</body>

</html>